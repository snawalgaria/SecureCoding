\chapter{Detailed Report}\label{chapter:details}

\section{Configuration and Deploy Management Testing}

\subsection{Test File Extensions Handling for Sensitive Information}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found various files which are served as plain text but are PHP source files. One of these files contains the credentials of the mail server. We were also able to download the compiled executable as well as the source code of the batch file parser. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/InternetBanking/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker can get sensitive information, e.g. credentials to the mail server or the database. He can analyze the source of the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{Forced Browsing Results:}
\begin{verbatim}
http://vm/InternetBanking/
http://vm/InternetBanking/DataAccess/
http://vm/InternetBanking/auth/
http://vm/InternetBanking/client/
http://vm/InternetBanking/controller/
http://vm/InternetBanking/controller/clientController.php
http://vm/InternetBanking/controller/clientFunctions.inc
http://vm/InternetBanking/controller/employeeController.php
http://vm/InternetBanking/controller/employeeFunctions.inc
http://vm/InternetBanking/controller/loginController.php
http://vm/InternetBanking/controller/logoutController.php
http://vm/InternetBanking/controller/registrationController.php
http://vm/InternetBanking/css/
http://vm/InternetBanking/css/bootstrap-theme.css
http://vm/InternetBanking/css/bootstrap-theme.css.map
http://vm/InternetBanking/css/bootstrap-theme.min.css
http://vm/InternetBanking/css/bootstrap.css
http://vm/InternetBanking/css/bootstrap.css.map
http://vm/InternetBanking/css/bootstrap.min.css
http://vm/InternetBanking/employee/
http://vm/InternetBanking/fonts/
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.eot
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.svg
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.ttf
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.woff
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.woff2
http://vm/InternetBanking/index/
http://vm/InternetBanking/js/
http://vm/InternetBanking/js/bootstrap.js
http://vm/InternetBanking/js/bootstrap.min.js
http://vm/InternetBanking/js/npm.js
http://vm/InternetBanking/login/
http://vm/InternetBanking/logout/
http://vm/InternetBanking/model/
http://vm/InternetBanking/model/Payment.class
http://vm/InternetBanking/model/PaymentRequest.class
http://vm/InternetBanking/model/User.class
http://vm/InternetBanking/model/UserRequest.class
http://vm/InternetBanking/parser/
http://vm/InternetBanking/parser/Makefile
http://vm/InternetBanking/parser/exec
http://vm/InternetBanking/parser/main.c
http://vm/InternetBanking/parser/mysql_query_function.c
http://vm/InternetBanking/parser/mysql_query_function.h
http://vm/InternetBanking/registration/
http://vm/InternetBanking/view/
http://vm/InternetBanking/view/account.inc
http://vm/InternetBanking/view/accounts.inc
http://vm/InternetBanking/view/approvepayments.inc
http://vm/InternetBanking/view/approveregistrations.inc
http://vm/InternetBanking/view/client.inc
http://vm/InternetBanking/view/employee.inc
http://vm/InternetBanking/view/file.inc
http://vm/InternetBanking/view/history.inc
http://vm/InternetBanking/view/historypdf.inc
http://vm/InternetBanking/view/login.inc
http://vm/InternetBanking/view/online.inc
http://vm/InternetBanking/view/registration.inc
\end{verbatim}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found some HTML snippets, which do not contain any sensitive information, and the compiled executable of the transaction file parser. We also found that the library TCPDF appears to be used. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/seccoding-2015/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker only has access to the parser executable, which might contain information about the database connection. He can analyze the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}


\paragraph{Forced Browsing Results:}
\begin{verbatim}
http://vm/seccoding-2015/
http://vm/seccoding-2015/database/
http://vm/seccoding-2015/html/
http://vm/seccoding-2015/html/auth.html
http://vm/seccoding-2015/html/dberror.html
http://vm/seccoding-2015/html/default.html
http://vm/seccoding-2015/html/display_userstate.html
http://vm/seccoding-2015/html/display_userstate_table.html
http://vm/seccoding-2015/html/dologin_fail.html
http://vm/seccoding-2015/html/dologin_success.html
http://vm/seccoding-2015/html/doregister_fail.html
http://vm/seccoding-2015/html/doregister_success.html
http://vm/seccoding-2015/html/edoverify_fail.html
http://vm/seccoding-2015/html/ehome.html
http://vm/seccoding-2015/html/ehome_transaction.html
http://vm/seccoding-2015/html/ehome_user.html
http://vm/seccoding-2015/html/entry_page.html
http://vm/seccoding-2015/html/etakeover.html
http://vm/seccoding-2015/html/etransactionpdf_fail.html
http://vm/seccoding-2015/html/home.html
http://vm/seccoding-2015/html/login.html
http://vm/seccoding-2015/html/register.html
http://vm/seccoding-2015/html/root.html
http://vm/seccoding-2015/html/simpleRoot.html
http://vm/seccoding-2015/html/transaction.html
http://vm/seccoding-2015/html/udotransactionupload_fail.html
http://vm/seccoding-2015/html/utransaction.html
http://vm/seccoding-2015/html/utransactionupload.html
http://vm/seccoding-2015/index/
http://vm/seccoding-2015/login/
http://vm/seccoding-2015/parser/
http://vm/seccoding-2015/parser/parser
http://vm/seccoding-2015/tcpdf/
http://vm/seccoding-2015/tcpdf/CHANGELOG.TXT
http://vm/seccoding-2015/tcpdf/LICENSE.TXT
http://vm/seccoding-2015/tcpdf/README.TXT
http://vm/seccoding-2015/tcpdf/composer.json
http://vm/seccoding-2015/tcpdf/config/
http://vm/seccoding-2015/tcpdf/config/tcpdf_config.php
http://vm/seccoding-2015/tcpdf/fonts/
http://vm/seccoding-2015/tcpdf/include/
http://vm/seccoding-2015/tcpdf/include/barcodes/
http://vm/seccoding-2015/tcpdf/include/barcodes/datamatrix.php
http://vm/seccoding-2015/tcpdf/include/barcodes/pdf417.php
http://vm/seccoding-2015/tcpdf/include/barcodes/qrcode.php
http://vm/seccoding-2015/tcpdf/include/sRGB.icc
http://vm/seccoding-2015/tcpdf/include/tcpdf_colors.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_filters.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_font_data.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_fonts.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_images.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_static.php
http://vm/seccoding-2015/tcpdf/tcpdf.php
http://vm/seccoding-2015/tcpdf/tcpdf_autoconfig.php
http://vm/seccoding-2015/tcpdf/tcpdf_barcodes_1d.php
http://vm/seccoding-2015/tcpdf/tcpdf_barcodes_2d.php
http://vm/seccoding-2015/tcpdf/tcpdf_import.php
http://vm/seccoding-2015/tcpdf/tcpdf_parser.php
http://vm/seccoding-2015/tcpdf/tools/
http://vm/seccoding-2015/tcpdf/tools/convert_fonts_examples.txt
http://vm/seccoding-2015/tcpdf/tools/tcpdf_addfont.php
\end{verbatim}

\subsubsection*{Comparison}
The web application of the SecureBank discloses less sensitive information. However, both applications disclose information which should not be available to unauthorized persons.

\clearpage

\subsection{Test HTTP Methods}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.


\clearpage
\subsection{Test HTTP Strict Transport Security}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage
\subsection{Test RIA cross domain policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage

\section{Identity Management Testing}

\subsection{Test Role Definitions}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & $\times$ \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients and employees & -- & $\times$ \\
Change account details and balance of clients and employees & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  We noticed that there are links to view the transaction history and change the account balance of employees, too. \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & -- \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The SecureBank web application does not offer a possibility for an employee to change the account balance of a client. However, the Online Banking application allows to view the transaction history and change the account balance also for employees, which have no account. This behaviour might be confusing.

\clearpage


\subsection{Test User Registration Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, a username, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. However, a person can register many times with the same username. (The activation of such an account fails with a database error.) We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or username using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, the full name, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or names using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application allows the double-registration of the same username at first, it only fails at the activation. This behaviour is confusing. Also, the application should ask for the full name be able to verify the name. Otherwise, there are no significant differences between both applications.

\clearpage



\subsection{Test Account Provisioning Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage





\subsection{Testing for Account Enumeration and Guessable User Account}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage


\subsection{Testing for Weak or unenforced username policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find a username policy.  \\
\textbf{Discovery} & We tested various usernames. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The username has to be a valid e-mail address of the client/employee. There is no policy regarding the e-mail address.  \\
\textbf{Discovery} & We tested valid and invalid e-mail addresses. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The only difference between the applications is that the Online Banking application uses usernames, which might have less correlation to the user than the e-mail address.

\clearpage



\section{Authentcation Testing}

\subsection{Testing for Credentials Transported over Encrypted Channel}

TODO!

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} &   \\
\textbf{Discovery} &  \\
\textbf{Impact} &  \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} &  \\
\textbf{Discovery} & \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}

\clearpage


\subsection{Testing for default credentials}
We decided to not test for default credentials, because we are working with custom software and therefore assume that all users and administrators choose secure passwords.

\clearpage


\subsection{Testing for Weak lock out mechanism}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find any lock out mechanism. Therefore, brute force attacks on passwords are possible. \\
\textbf{Discovery} & We entered a valid username and incorrect passwords 10 times, and always got the error message about an incorrect password. Afterwards, we were able to log in with a correct password. \\
\textbf{Impact} & An attacker can brute-force the password of any user and therefore take the user over. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find any lock out mechanism. Therefore, brute force attacks on passwords are possible. \\
\textbf{Discovery} & We entered a valid username and incorrect passwords 10 times, and always got the error message about the failed login. Afterwards, we were able to log in with a correct password. \\
\textbf{Impact} & An attacker can brute-force the password of any user and therefore take the user over. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide any lock out mechanism.

\clearpage




\subsection{Testing for bypassing authentication schema}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were able to bypass the authentication schema via a SQL injection. This gave us the ability to login as any user without knowing the password. \\
\textbf{Discovery} & Using the fuzzer \texttt{jbrofuzz / SQL Injection} of ZAP on the username field of the login page, we were able to login as \texttt{admin} or another user without knowing the password. We had no success with direct page requests, modifiying the session ID and parameter modification. \\
\textbf{Impact} & An attacker can take over a user without knowing the valid access credentials. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to bypass the authentication schema. \\
\textbf{Discovery} & Using the fuzzer \texttt{jbrofuzz / SQL Injection} of ZAP and SQLmap on the username field of the login page, we were not able to find SQL injection vulnerabilities to bypass the authentication schema. We also had no success with direct page requests, modifiying the session ID and parameter modification.   \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application provides a way to bypass the authentication schema via SQL injection. The SecureBank application does not offer such vulnerabilities.

\clearpage

\subsection{Testing for Vulnerable Remember Password}
We did not found a remember password functionality, so we decided to not further test on this.

\clearpage

\subsection{Testing for Browser Cache Weakness}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Clicking the back button in the browser does not cause a re-login. All sites have the header \texttt{Cache-Control: no-store, no-cache, must-revaildate, post-check=0, pre-check=0} and the \texttt{Pragma: no-cache} as well as an \texttt{Expires: <date in the past>} header set. \\
\textbf{Discovery} & Using ZAP, we analyzed the response header for different pages which are only available when a user is logged in.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Clicking the back button in the browser does not cause a re-login. All sites have the header \texttt{Cache-Control: no-store, no-cache, must-revaildate, post-check=0, pre-check=0} and the \texttt{Pragma: no-cache} as well as an \texttt{Expires: <date in the past>} header set. \\
\textbf{Discovery} & Using ZAP, we analyzed the response header for different pages which are only available when a user is logged in.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There is no significant difference between both applications.

\clearpage


\subsection{Testing for Weak password policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is a password policy enforced, which states that a password has have a length $\geq6$ and has to include at least one number, one lowercase character, one uppercase character and one symbol. There is no way to change the password. The password does not expire. \\
\textbf{Discovery} & We tested various passwords, like \texttt{123456}. If a password does not match the policy, an error message is shown which informs the user about the policy. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The password has to have a length $\geq 6$. There is no way to change the password. The password does not expire. \\
\textbf{Discovery} &  We tested various passwords, like \texttt{123456}. If a password does not match the policy, an error message is shown which informs the user about the policy.  \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking application enforces a more strict password policy than the SecureBank application. This reduces the risk of brute force attacks.

\clearpage

\subsection{Testing for Weak security question/answer}
We could not find such functionality in both application. Therefore, we decidede to not proceed testing on this.

\subsection{Testing for Weak password change or reset functionalities}
We could not find such functionality in both application. Therefore, we decidede to not proceed testing on this.

\subsection{Testing for Weaker authentication in alternative channel}
We could not find an alternative channel for authentication. Therefore, we decidede to not proceed testing on this.

\clearpage

\section{Authorization Testing}

\subsection{Testing Directory traversal/file include}
TODO!
\subsection{Testing for bypassing authorization schema}
TODO!
\subsection{Testing for Privilege Escalation}
TODO!
\subsection{Testing for Insecure Direct Object References}
TODO!

\section{Session Management Testing}
TODO!

\section{Data Validation Testing}

TODO!

\subsection{Testing for Reflected Cross Site Scripting}
\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & In combination with a SQL injection vulnerability, we were able to inject scripts into the users home page. \\
\textbf{Discovery} & As we know from previous testing, that the login page is vulnerable to SQL injection, we were able to use \texttt{admin' AND '<script>alert("XSS")</script>'='<script>alert("XSS")</script>} as username. We also tried to enter some basic script parts into the fields of the registration form and the transaction form, but they are not reflected. \\
\textbf{Impact} & An attacker can induce scripts into the users pages and therefore track all entered information and modify them. \\
\textbf{Likelihood} & Low \\
\textbf{Access Vector} & Local \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find any reflected XSS vulnerability. \\
\textbf{Discovery} & We tried to inject basic scripts into the register, login and transaction form as well as into the administration form.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}



\subsection{Testing for LDAP/ORM/XML/SSI/XPath Injection}
We did not test any of these injection types as it appears that these techniques are not used in any of the two applications. Therefore, we decided to not further investigate in these types of injection.

\subsection{Testing for SQL injection}
\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were able to log into the application as any user without knowing the passwordand to perform transactions with any unused TAN of any user when uploading a transaction batch file. \\
\textbf{Discovery} & We used the fuzzer of ZAP on the username field of the login form, with the query parameters \texttt{username=admin\&password=123}, where the fuzzing point was at the end of the username. We compared the answers of the server and found that in one case we got redirected to the employee page. We analyzed the login page also using SQLmap, which delivered a similar result. Additionally, we ran SQLmap on the fields of the perform transaction form, it returned that none of the four inputs where exploitable for SQL injection.

We tested the fields of the transaction batch form manually by trying some standard SQL injection parts (e.g. \texttt{';--} and \texttt{";--}). We noted that the application gives no usual feedback when uploading a transaction file where the username or the comment contains strings that apparantly results in a syntactically erroneous SQL query. We continued to determine the table structure using a brute force script which tests for some expectable table and column names, the results can be found below. Finally, we were able to exploit the SQL injection vulnerability in the TAN field to use any unused TAN from any user. \\
\textbf{Impact} & An attacker can log into any account, of which he knows the username, and perform transactions without knowing valid TANs for that account by uploading a transaction batch file. Furthermore, as an attacker can take over an administrator account, if he knows the username, he has access to all accounts and can change the account balances at will. Also, an attacker can analyze the structure of a database. \\
\textbf{Likelihood} & High \\
\end{tabular}

\paragraph{Login vulnerability}

\begin{tabular}{l|p{10cm}}
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{TAN vulnerability}

\begin{tabular}{l|p{10cm}}
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & Low \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{Results of the brute-force script}

\begin{verbatim}
Table payment: id, trancode, payer, receipt, amount, purpose
Table user: id, balance, email, username, password, isemployee
Table userrequest: id, email, username, password, isemployee
Table paymentrequest: id, trancode, payer, receipt, amount, purpose
Table trancode: id, clientid
\end{verbatim}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} &  \\
\textbf{Discovery} & We used the fuzzer of ZAP on the username field of the login form, with the query parameters \texttt{username=admin@localhost\&password=123}, where the fuzzing point was at the end of the username. We also analyzed the login page also using SQLmap. Using both methods, we were not able to log in without knowing the password. Additionally, we ran SQLmap on the fields of the registration form and the perform transaction form, it returned that none of the four inputs where exploitable for SQL injection. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application is vulnerable to SQL injection at different places, allowing an attacker to take over user accounts and transfer money without knowing any credentials. In the web application of the SecureBank, we were not able to find SQL injection vulnerabilities.

\clearpage



\section{Error Handling}

\subsection{Analysis of Error Codes}
\subsubsection*{Online Banking}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to get reveal any information about the database, but we were able to get usual error codes of an apache server. The error pages also revealed information about the version, which is 2.2.22 on an Ubuntu server. \\
\textbf{Discovery} & By using the fuzzer \texttt{jbrofuzz / SQL Injection / MySQL Injection 101} of ZAP on the purpose field of the online transaction form, we got one response which simply stated \texttt{Database error}, but gave no further information. Using a browser, we requested the page \texttt{/InternetBanking/foobar/}, which returned a 404 error, with further information about the server operating system and the Apache version. \\
\textbf{Impact} & Using the apache version, an attacker can run known exploits for this specific version. \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & No Impact \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to get reveal any information about the database, but we were able to get usual error codes of an apache server. The error pages also revealed information about the version, which is 2.2.22 on an Ubuntu server. On the login page, we found an error code if the login was unsuccessful. Apparently, the code is always 1, if the credentials are incorrect. \\
\textbf{Discovery} & By using the fuzzer \texttt{jbrofuzz / SQL Injection / MySQL Injection 101} of ZAP on the purpose field of the online transaction form, we were not able to produce a databse error. Using a browser, we requested the page \texttt{/seccoding-2015/foobar/}, which returned a 404 error, with further information about the server operating system and the Apache version. \\
\textbf{Impact} & Using the apache version, an attacker can run known exploits for this specific version. \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & No Impact \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{Comparison}
Although the Online Banking application produces an error message about a database error, they provide the similar information in error messages.

\subsection{Testing for Stack Traces}
We were not able to produce stack traces in both applications using invalid inputs (e.g. negative numbers), or SQL injection.

\section{Testing for weak Cryptography}
TODO!

\section{Business Logic Testing}
TODO!

\section{Client Side Testing}
TODO!

