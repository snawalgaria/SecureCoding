\chapter{Detailed Report}\label{chapter:details}

\section{Configuration and Deploy Management Testing}

\subsection{Test File Extensions Handling for Sensitive Information}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found various files which are served as plain text but are PHP source files. One of these files contains the credentials of the mail server. We were also able to download the compiled executable as well as the source code of the batch file parser. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/InternetBanking/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker can get sensitive information, e.g. credentials to the mail server or the database. He can analyze the source of the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{Forced Browsing Results:}
\begin{verbatim}
http://vm/InternetBanking/
http://vm/InternetBanking/DataAccess/
http://vm/InternetBanking/auth/
http://vm/InternetBanking/client/
http://vm/InternetBanking/controller/
http://vm/InternetBanking/controller/clientController.php
http://vm/InternetBanking/controller/clientFunctions.inc
http://vm/InternetBanking/controller/employeeController.php
http://vm/InternetBanking/controller/employeeFunctions.inc
http://vm/InternetBanking/controller/loginController.php
http://vm/InternetBanking/controller/logoutController.php
http://vm/InternetBanking/controller/registrationController.php
http://vm/InternetBanking/css/
http://vm/InternetBanking/css/bootstrap-theme.css
http://vm/InternetBanking/css/bootstrap-theme.css.map
http://vm/InternetBanking/css/bootstrap-theme.min.css
http://vm/InternetBanking/css/bootstrap.css
http://vm/InternetBanking/css/bootstrap.css.map
http://vm/InternetBanking/css/bootstrap.min.css
http://vm/InternetBanking/employee/
http://vm/InternetBanking/fonts/
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.eot
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.svg
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.ttf
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.woff
http://vm/InternetBanking/fonts/glyphicons-halflings-regular.woff2
http://vm/InternetBanking/index/
http://vm/InternetBanking/js/
http://vm/InternetBanking/js/bootstrap.js
http://vm/InternetBanking/js/bootstrap.min.js
http://vm/InternetBanking/js/npm.js
http://vm/InternetBanking/login/
http://vm/InternetBanking/logout/
http://vm/InternetBanking/model/
http://vm/InternetBanking/model/Payment.class
http://vm/InternetBanking/model/PaymentRequest.class
http://vm/InternetBanking/model/User.class
http://vm/InternetBanking/model/UserRequest.class
http://vm/InternetBanking/parser/
http://vm/InternetBanking/parser/Makefile
http://vm/InternetBanking/parser/exec
http://vm/InternetBanking/parser/main.c
http://vm/InternetBanking/parser/mysql_query_function.c
http://vm/InternetBanking/parser/mysql_query_function.h
http://vm/InternetBanking/registration/
http://vm/InternetBanking/view/
http://vm/InternetBanking/view/account.inc
http://vm/InternetBanking/view/accounts.inc
http://vm/InternetBanking/view/approvepayments.inc
http://vm/InternetBanking/view/approveregistrations.inc
http://vm/InternetBanking/view/client.inc
http://vm/InternetBanking/view/employee.inc
http://vm/InternetBanking/view/file.inc
http://vm/InternetBanking/view/history.inc
http://vm/InternetBanking/view/historypdf.inc
http://vm/InternetBanking/view/login.inc
http://vm/InternetBanking/view/online.inc
http://vm/InternetBanking/view/registration.inc
\end{verbatim}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found some HTML snippets, which do not contain any sensitive information, and the compiled executable of the transaction file parser. We also found that the library TCPDF appears to be used. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/seccoding-2015/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker only has access to the parser executable, which might contain information about the database connection. He can analyze the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}


\paragraph{Forced Browsing Results:}
\begin{verbatim}
http://vm/seccoding-2015/
http://vm/seccoding-2015/database/
http://vm/seccoding-2015/html/
http://vm/seccoding-2015/html/auth.html
http://vm/seccoding-2015/html/dberror.html
http://vm/seccoding-2015/html/default.html
http://vm/seccoding-2015/html/display_userstate.html
http://vm/seccoding-2015/html/display_userstate_table.html
http://vm/seccoding-2015/html/dologin_fail.html
http://vm/seccoding-2015/html/dologin_success.html
http://vm/seccoding-2015/html/doregister_fail.html
http://vm/seccoding-2015/html/doregister_success.html
http://vm/seccoding-2015/html/edoverify_fail.html
http://vm/seccoding-2015/html/ehome.html
http://vm/seccoding-2015/html/ehome_transaction.html
http://vm/seccoding-2015/html/ehome_user.html
http://vm/seccoding-2015/html/entry_page.html
http://vm/seccoding-2015/html/etakeover.html
http://vm/seccoding-2015/html/etransactionpdf_fail.html
http://vm/seccoding-2015/html/home.html
http://vm/seccoding-2015/html/login.html
http://vm/seccoding-2015/html/register.html
http://vm/seccoding-2015/html/root.html
http://vm/seccoding-2015/html/simpleRoot.html
http://vm/seccoding-2015/html/transaction.html
http://vm/seccoding-2015/html/udotransactionupload_fail.html
http://vm/seccoding-2015/html/utransaction.html
http://vm/seccoding-2015/html/utransactionupload.html
http://vm/seccoding-2015/index/
http://vm/seccoding-2015/login/
http://vm/seccoding-2015/parser/
http://vm/seccoding-2015/parser/parser
http://vm/seccoding-2015/tcpdf/
http://vm/seccoding-2015/tcpdf/CHANGELOG.TXT
http://vm/seccoding-2015/tcpdf/LICENSE.TXT
http://vm/seccoding-2015/tcpdf/README.TXT
http://vm/seccoding-2015/tcpdf/composer.json
http://vm/seccoding-2015/tcpdf/config/
http://vm/seccoding-2015/tcpdf/config/tcpdf_config.php
http://vm/seccoding-2015/tcpdf/fonts/
http://vm/seccoding-2015/tcpdf/include/
http://vm/seccoding-2015/tcpdf/include/barcodes/
http://vm/seccoding-2015/tcpdf/include/barcodes/datamatrix.php
http://vm/seccoding-2015/tcpdf/include/barcodes/pdf417.php
http://vm/seccoding-2015/tcpdf/include/barcodes/qrcode.php
http://vm/seccoding-2015/tcpdf/include/sRGB.icc
http://vm/seccoding-2015/tcpdf/include/tcpdf_colors.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_filters.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_font_data.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_fonts.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_images.php
http://vm/seccoding-2015/tcpdf/include/tcpdf_static.php
http://vm/seccoding-2015/tcpdf/tcpdf.php
http://vm/seccoding-2015/tcpdf/tcpdf_autoconfig.php
http://vm/seccoding-2015/tcpdf/tcpdf_barcodes_1d.php
http://vm/seccoding-2015/tcpdf/tcpdf_barcodes_2d.php
http://vm/seccoding-2015/tcpdf/tcpdf_import.php
http://vm/seccoding-2015/tcpdf/tcpdf_parser.php
http://vm/seccoding-2015/tcpdf/tools/
http://vm/seccoding-2015/tcpdf/tools/convert_fonts_examples.txt
http://vm/seccoding-2015/tcpdf/tools/tcpdf_addfont.php
\end{verbatim}

\subsubsection*{Comparison}
The web application of the SecureBank discloses less sensitive information. However, both applications disclose information which should not be available to unauthorized persons.

\clearpage

\subsection{Test HTTP Methods}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.


\clearpage
\subsection{Test HTTP Strict Transport Security}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage
\subsection{Test RIA cross domain policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage

\section{Identity Management Testing}

\subsection{Test Role Definitions}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & $\times$ \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients and employees & -- & $\times$ \\
Change account details and balance of clients and employees & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  We noticed that there are links to view the transaction history and change the account balance of employees, too. \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & -- \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The SecureBank web application does not offer a possibility for an employee to change the account balance of a client. However, the Online Banking application allows to view the transaction history and change the account balance also for employees, which have no account. This behaviour might be confusing.

\clearpage


\subsection{Test User Registration Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, a username, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. However, a person can register many times with the same username. (The activation of such an account fails with a database error.) We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or username using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, the full name, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or names using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application allows the double-registration of the same username at first, it only fails at the activation. This behaviour is confusing. Also, the application should ask for the full name be able to verify the name. Otherwise, there are no significant differences between both applications.

\clearpage



\subsection{Test Account Provisioning Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage





\subsection{Testing for Account Enumeration and Guessable User Account}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage


\subsection{Testing for Weak or unenforced username policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find a username policy.  \\
\textbf{Discovery} & We tested various usernames. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The username has to be a valid e-mail address of the client/employee. There is no policy regarding the e-mail address.  \\
\textbf{Discovery} & We tested valid and invalid e-mail addresses. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The only difference between the applications is that the Online Banking application uses usernames, which might have less correlation to the user than the e-mail address.

\clearpage



\section{Authentcation Testing}

\subsection{Testing for Credentials Transported over Encrypted Channel}
See Section \ref{subsec:encryption}.

\subsection{Testing for default credentials}
We decided to not test for default credentials, because we are working with custom software and therefore assume that all users and administrators choose secure passwords.

\clearpage


\subsection{Testing for Weak lock out mechanism}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find any lock out mechanism. Therefore, brute force attacks on passwords are possible. \\
\textbf{Discovery} & We entered a valid username and incorrect passwords 10 times, and always got the error message about an incorrect password. Afterwards, we were able to log in with a correct password. \\
\textbf{Impact} & An attacker can brute-force the password of any user and therefore take the user over. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find any lock out mechanism. Therefore, brute force attacks on passwords are possible. \\
\textbf{Discovery} & We entered a valid username and incorrect passwords 10 times, and always got the error message about the failed login. Afterwards, we were able to log in with a correct password. \\
\textbf{Impact} & An attacker can brute-force the password of any user and therefore take the user over. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide any lock out mechanism.

\clearpage




\subsection{Testing for bypassing authentication schema}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were able to bypass the authentication schema via a SQL injection. This gave us the ability to login as any user without knowing the password. \\
\textbf{Discovery} & Using the fuzzer \texttt{jbrofuzz / SQL Injection} of ZAP on the username field of the login page, we were able to login as \texttt{admin} or another user without knowing the password. We had no success with direct page requests, modifiying the session ID and parameter modification. \\
\textbf{Impact} & An attacker can take over a user without knowing the valid access credentials. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to bypass the authentication schema. \\
\textbf{Discovery} & Using the fuzzer \texttt{jbrofuzz / SQL Injection} of ZAP and SQLmap on the username field of the login page, we were not able to find SQL injection vulnerabilities to bypass the authentication schema. We also had no success with direct page requests, modifiying the session ID and parameter modification.   \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application provides a way to bypass the authentication schema via SQL injection. The SecureBank application does not offer such vulnerabilities.

\clearpage

\subsection{Testing for Vulnerable Remember Password}
We did not found a remember password functionality, so we decided to not further test on this.

\clearpage

\subsection{Testing for Browser Cache Weakness}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Clicking the back button in the browser does not cause a re-login. All sites have the header \texttt{Cache-Control: no-store, no-cache, must-revaildate, post-check=0, pre-check=0} and the \texttt{Pragma: no-cache} as well as an \texttt{Expires: <date in the past>} header set. \\
\textbf{Discovery} & Using ZAP, we analyzed the response header for different pages which are only available when a user is logged in.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Clicking the back button in the browser does not cause a re-login. All sites have the header \texttt{Cache-Control: no-store, no-cache, must-revaildate, post-check=0, pre-check=0} and the \texttt{Pragma: no-cache} as well as an \texttt{Expires: <date in the past>} header set. \\
\textbf{Discovery} & Using ZAP, we analyzed the response header for different pages which are only available when a user is logged in.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There is no significant difference between both applications.

\clearpage


\subsection{Testing for Weak password policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is a password policy enforced, which states that a password has have a length $\geq6$ and has to include at least one number, one lowercase character, one uppercase character and one symbol. There is no way to change the password. The password does not expire. \\
\textbf{Discovery} & We tested various passwords, like \texttt{123456}. If a password does not match the policy, an error message is shown which informs the user about the policy. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The password has to have a length $\geq 8$. There is no way to change the password. The password does not expire. \\
\textbf{Discovery} &  We tested various passwords, like \texttt{123456}. If a password does not match the policy, an error message is shown which informs the user about the policy.  \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking application enforces a more strict password policy than the SecureBank application. This reduces the risk of brute force attacks.

\clearpage

\subsection{Testing for Weak security question/answer}
We could not find such functionality in both application. Therefore, we decidede to not proceed testing on this.

\subsection{Testing for Weak password change or reset functionalities}
We could not find such functionality in both application. Therefore, we decidede to not proceed testing on this.

\subsection{Testing for Weaker authentication in alternative channel}
We could not find an alternative channel for authentication. Therefore, we decidede to not proceed testing on this.

\clearpage

\section{Authorization Testing}

\subsection{Testing Directory traversal/file include}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We could not get access to sensitive files like \texttt{/etc/passwd}. \\
\textbf{Discovery} & We manually tried to access the client main site with different values for the parameter \texttt{action}, like \texttt{action=../../../etc/passwd}. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We could not get access to sensitive files like \texttt{/etc/passwd}. \\
\textbf{Discovery} & We manually tried to access the site with different values for the parameter \texttt{page}, like \texttt{page=../../../etc/passwd}. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide file include vulnerabilities.

\clearpage
\subsection{Testing for bypassing authorization schema}


\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to bypass the authorization schema \\
\textbf{Discovery} & We manually tried to access the employee page while being logged in as a client and got the error message \texttt{Not employee}. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} &  We were unable to bypass the authorization schema \\
\textbf{Discovery} & We manually tried to access the employee pages like \texttt{edoverify} while being logged in as a client and got the error message \texttt{You are not authenticated to do this}. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide vulnerabilities that allow to bypass the authorization schema.

\clearpage

\subsection{Testing for Privilege Escalation}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to get the privileges of another user. \\
\textbf{Discovery} & We manually tried to access the employee page while being logged in as a client and got the error message \texttt{Not employee}. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} &  We were unable to get the privileges of another user.\\
\textbf{Discovery} & We manually tried to access the employee pages like \texttt{edoverify} while being logged in as a client and got the error message \texttt{You are not authenticated to do this}. We also tried to change the account number of the \texttt{userid} GET parameter when downloading a PDF, without success. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide vulnerabilities that allow a privilege escalation.

\clearpage

\subsection{Testing for Insecure Direct Object References}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to find insecure direct object references. \\
\textbf{Discovery} & We manually changed the GET parameter \texttt{action} using ZAP. However, we either got an empty page or the requested page. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to find insecure direct object references. \\
\textbf{Discovery} & We manually changed the GET parameter \texttt{page}. However, we either got an error message or the requested page. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications do not provide vulnerabilities that allow insecure direct object references.

\clearpage









\section{Session Management Testing}

\subsection{Testing for Bypassing Session Management Schema}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Only cookies for the PHP session ID were used. This hints at the cookies being rather secure. Using BurpSuite's sequencer we confirm that the entropy is excellent. However, the cookies are sent over an unencrypted connection, which can be exploited with a MitM attack. By stealing the session from a user (admin or not), we would be able to impersonate them and do actions in their name. This compromises the integrity of the application. \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} &Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Only cookies for the PHP session ID were used. This hints at the cookies being rather secure. Using BurpSuite's sequencer we confirm that the entropy is excellent. However, the cookies are sent over an unencrypted connection, which can be exploited with a MitM attack. By stealing the session from a user (admin or not), we would be able to impersonate them and do actions in their name. This compromises the integrity of the application. \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} &Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{Comparison}
Both applications are equally secure/insecure regarding this.

\clearpage


\subsection{Testing for Cookies attributes}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Since only the PHP session ID is saved as cookie, no attributes are saved in any cookies. Obviously there's no attack to execute  \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Only cookies for the PHP session ID were used. This hints at the cookies being rather secure. Using BurpSuite's sequencer we confirm that the entropy is excellent. Not attacks are possible at this point. \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications have no attributes other than the Session ID and are thus secure under this aspect.

\clearpage


\subsection{Testing for Session Fixation}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Cookies aren't renewed when logging in. An attacker might create a session and make the user authenticate with it, thus giving the attacker access to the victim's session. \\
\textbf{Discovery} & Firefox Developer tools \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Cookies aren't renewed when logging in. An attacker might create a session and make the user authenticate with it, thus giving the attacker access to the victim's session. \\
\textbf{Discovery} & Firefox Developer tools \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{Comparison}
Both applications have the session fixation vulnerability.

\clearpage


\subsection{Testing for Exposed Session Variables}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The cookies are sent over an unencrypted connection. Cookies also aren't renewed when logging in. By using MitM to steal the session from a user (admin or not), we would be able to impersonate them and do actions in their name. This compromises the integrity of the application. \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The cookies are sent over an unencrypted connection. Cookies also aren't renewed when logging in. By using MitM to steal the session from a user (admin or not), we would be able to impersonate them and do actions in their name. This compromises the integrity of the application. \\
\textbf{Discovery} & BurpSuite \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes, the user has to do any action for which the cookie will be transmitted. \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{Comparison}
Both applications are equally insecure regarding this.

\clearpage


\subsection{Testing for Cross Site Request Forgery}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & There is no mechanism to prohibit CSRF. GET requests aren't enough, though, since all of the important data is only transmitted via POST requests. By getting our victim to open a malicious web page, that creates a POST request with JS, we would be able to perform actions in their name. \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & There is no mechanism to prohibit CSRF. GET requests aren't enough, though, since all of the important data is only transmitted via POST requests. By getting our victim to open a malicious web page, that creates a POST request with JS, we would be able to perform actions in their name. \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & Medium/High, depending on the victim's priviledges \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & Yes \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & High\\
\textbf{Availability} & None \\
\end{tabular}

\subsubsection*{Comparison}
Both applications are equally insecure regarding this.

\clearpage


\subsection{Testing for logout functionality}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The logout button is easily visible and works as it should: It invalidates the session. \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The logout button is easily visible and works as it should: It invalidates the session. \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications have a correctly implemented logout function.

\clearpage


\subsection{Test Session Timeout}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The user is automatically logged out after 10 minutes of inactivity. TODO: Is he? \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The user is automatically logged out after 10 minutes of inactivity. \\
\textbf{Discovery} & Manual test \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications have a correctly implemented logout function.

\clearpage


\subsection{Testing for Session puzzling}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & We found no way to perform Session Puzzling. The same cookie is used for all interactions. \\
\textbf{Discovery} & Zap, w3af \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & We found no way to perform Session Puzzling. The same cookie is used for all interactions. \\
\textbf{Discovery} & Zap, w3af \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications aren't vulnerable to Session puzzling.

\clearpage










\section{Data Validation Testing}

\subsection{Testing for Reflected Cross Site Scripting}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The only GET parameters are "action" and if logged in as employee, "account". When entering an action name that doesn't exist, the fake name is not displayed in any kind of error message. The same happens if the input account doesn't exist. If the account exists and the username is equal to some XSS attack, that should be considered a stored XSS attack instead. Thus, there's no attack vector for Reflected XSS. \\
\textbf{Discovery} & w3af (XSS plugin) and manually  \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The only GET parameter is "page". When entering a page name that doesn't exist, the fake name is not displayed in any kind of error message. Thus, there's no attack vector for Reflected XSS. \\
\textbf{Discovery} & w3af (XSS plugin) and manually \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications allowed no reflected XSS.

\clearpage


\subsection{Testing for Stored Cross Site Scripting}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & Stored XSS can be injected via the username when registering and into the purpose field when making transactions. The email used for registration, however, is checked for validity. User names can't be longer than 32 signs. This is just enough to inject something like \texttt{<script src=//bit.ly/1MvAdrm>}. Users who register after this exploit has been used won't be shown, since the end tag is missing. For the transaction's description there is more space, but an account is needed. \\
\textbf{Discovery} & TODO\\
\textbf{Impact} & Using this it's possible to e.g. automatically accept payments of over 10000 as soon as an admin opens the "Approve Transfers" page. Given a user's TAN, it's also possible to transfer their money into one's own account by sending them a manipulated transaction. The manipulated transaction just has to include code that creates a transaction in the victim's name. Furthermore, it's possible to steal sessions or, by injecting fake login forms even credentials of admins. By injecting into the username, the attacker can also auto-accept themselves as real user as soon as an admin opens the "Approve Registrations" tab. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & N/L: None for the registration XSS, Low user priviledges for XSS in transactions\\
\textbf{User Interaction} & Yes \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High\\
\textbf{Availability} & Low \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & User names are escaped, so XSS is impossible here. Transaction descriptions, however, still allow XSS. It isn't triggered on the page where transactions will be verified by employees, but by opening the recipient's (or the attacker's) transaction history. This way it's just slightly harder to get the admin's credentials. Getting to the recipient's account is as easy as in Online Banking's app. \\
\textbf{Discovery} & TODO \\
\textbf{Impact} & Using this it's possible to e.g. automatically accept payments of over 10000 as soon as an admin opens the "Approve Transfers" page. Given a user's TAN, it's also possible to transfer their money into one's own account by sending them a manipulated transaction. The manipulated transaction just has to include code that creates a transaction in the victim's name. Furthermore, it's possible to steal sessions or, by injecting fake login forms even credentials of admins. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low\\
\textbf{Privileges Required} & normal user priviledges \\
\textbf{User Interaction} & Yes\\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High\\
\textbf{Intigrity} & High \\
\textbf{Availability} & None\\
\end{tabular}

\subsubsection*{Comparison}
Both applications allowed for stored XSS, but Online Banking was easier to compromise (no account needed).
Our application is the better one in this regard.

\clearpage


\subsection{Testing for HTTP Verb Tampering}

\subsubsection*{Online Banking}
TODO: what harm does Verb Tampering do?

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & When trying all HTTP methods, CONNECT returns "Bad Request", while OPTIONS returns "OK". Otherwise, all methods except GET and POST are not allowed\\
\textbf{Discovery} & script http\_tampering.sh in phase2/scripts/ (from OWASP website) \\
\textbf{Impact} & The web server might respond in unexpected ways to these methods. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & HTTP request for CONNECT or OPTIONS\\
\textbf{Access Complexity} & \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & \\
\textbf{Intigrity} & \\
\textbf{Availability} & \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & When trying all HTTP methods, CONNECT returns "Bad Request", while OPTIONS returns "OK". Otherwise, all methods except GET and POST are not allowed\\
\textbf{Discovery} & script http\_tampering.sh in phase2/scripts/ (from OWASP website)\\
\textbf{Impact} & The web server might respond in unexpected ways to these methods.\\
\textbf{Likelihood} & \\
\textbf{Access Vector} & \\
\textbf{Access Complexity} & \\
\textbf{Privileges Required} & \\
\textbf{User Interaction} & \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & \\
\textbf{Intigrity} & \\
\textbf{Availability} & \\
\end{tabular}

\subsection{Testing for HTTP Parameter pollution}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The application behaves as it should, ignoring all but the last parameter with the same name. Trying to e.g. pollute the email during registration with a value that has the wrong format shows "Email is invalid". \\
\textbf{Discovery} & Manipulated parameters using BurpSuite manually, since HPP apparently can't really be tested using tools (too many false positives)\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The application behaves as it should, ignoring all but the last parameter with the same name. Trying to e.g. pollute the email during registration registers the user with the last email parameter, if the email hasn't been taken.\\
\textbf{Discovery} & Manipulated parameters using BurpSuite manually, since HPP apparently can't really be tested using tools (too many false positives)\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both apps are protected against HTTP parameter pollution.

\clearpage


\subsection{Testing for SQL injection}
\subsubsection*{Online Banking}\label{sql:injection:online}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were able to log into the application as any user without knowing the passwordand to perform transactions with any unused TAN of any user when uploading a transaction batch file. \\
\textbf{Discovery} & We used the fuzzer of ZAP on the username field of the login form, with the query parameters \texttt{username=admin\&password=123}, where the fuzzing point was at the end of the username. We compared the answers of the server and found that in one case we got redirected to the employee page. We analyzed the login page also using SQLmap, which delivered a similar result. Additionally, we ran SQLmap on the fields of the perform transaction form, it returned that none of the four inputs where exploitable for SQL injection.

We tested the fields of the transaction batch form manually by trying some standard SQL injection parts (e.g. \texttt{';--} and \texttt{";--}). We noted that the application gives no usual feedback when uploading a transaction file where the username or the comment contains strings that apparantly results in a syntactically erroneous SQL query. We continued to determine the table structure using a brute force script which tests for some expectable table and column names, the results can be found below. Finally, we were able to exploit the SQL injection vulnerability in the TAN field to use any unused TAN from any user. \\
\textbf{Impact} & An attacker can log into any account, of which he knows the username, and perform transactions without knowing valid TANs for that account by uploading a transaction batch file. Furthermore, as an attacker can take over an administrator account, if he knows the username, he has access to all accounts and can change the account balances at will. Also, an attacker can analyze the structure of a database. \\
\textbf{Likelihood} & High \\
\end{tabular}

\paragraph{Login vulnerability}

\begin{tabular}{l|p{10cm}}
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{TAN vulnerability}

\begin{tabular}{l|p{10cm}}
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & Low \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High \\
\textbf{Availability} & No Impact \\
\end{tabular}

\paragraph{Results of the brute-force script}

\begin{verbatim}
Table payment: id, trancode, payer, receipt, amount, purpose
Table user: id, balance, email, username, password, isemployee
Table userrequest: id, email, username, password, isemployee
Table paymentrequest: id, trancode, payer, receipt, amount, purpose
Table trancode: id, clientid
\end{verbatim}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No SQL injections found \\
\textbf{Discovery} & We used the fuzzer of ZAP on the username field of the login form, with the query parameters \texttt{username=admin@localhost\&password=123}, where the fuzzing point was at the end of the username. We also analyzed the login page also using SQLmap. Using both methods, we were not able to log in without knowing the password. Additionally, we ran SQLmap on the fields of the registration form and the perform transaction form, it returned that none of the four inputs where exploitable for SQL injection. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application is vulnerable to SQL injection at different places, allowing an attacker to take over user accounts and transfer money without knowing any credentials. In the web application of the SecureBank, we were not able to find SQL injection vulnerabilities.

\clearpage


\subsection{Testing for LDAP Injection}
\subsection{Testing for ORM Injection}
\subsection{Testing for XML Injection}
\subsection{Testing for SSI Injection}
\subsection{Testing for XPath Injection}
We did not test any of these injection types as it appears that these techniques are not used in any of the two applications. Therefore, we decided to not further investigate in these types of injection.

\subsection{IMAP/SMTP Injection}

We don't want to attack the used mail servers, since they're probably not part of the programming part. And we don't want to go to prison for trying to hack gmail.

\clearpage


\subsection{Testing for Code Injection}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & The only code injection we found is the SQL injection in the uploaded file, as described in \ref{sql:injection:online}. Apart from that nothing was found.\\
\textbf{Discovery} & Tested the action parameter in the GET requests. Our tools found no Code Injections either.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & No vulnerability found.\\
\textbf{Discovery} & Tested the page parameter in the GET requests. Our tools found no Code Injections either.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
If we count the SQL injection in the uploaded file to the point about SQL injection, both applications perform the same.

\clearpage


\subsection{Testing for Command Injection}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & W3af found two places where it suspected possible command injection via eval(). Both of these places turned out to just be SQL injection again, though. Apart from this we found no command injection.\\
\textbf{Discovery} & W3af and then manual testing.\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}
\textbf{Observation} & We found no places where command injection is possible\\
\textbf{Discovery} & W3AF, ZAP\\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications allow no command injections (to the OS).


\subsection{Testing for Buffer overflow}
\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were able to induce a buffer overflow by putting a string of $258$ \texttt{a}s into the TAN purpose field of the uploaded transaction batch file, although we could not identify whether this a stack or a heap buffer overflow. We were not able to cause a buffer overflow by using formatting characters. The transaction gets executed correctly, except that the purpose field is empty, though. \\
\textbf{Discovery} & Using the fuzzer of ZAP, we used the \texttt{jbrofuzz / Buffer Overflows / Long string's of a's} fuzzing base on the transaction purpose field of the uploaded transaction batch file. For string smaller with a length smaller than 255 bytes, the transaction gets executed, and for very large strings, the application claims that the file is too large. However, in the other cases, the application gives no feedback, as described in Section \ref{sql:injection:online}. We also tried to cause buffer overflows caused by string format function by including strings like \texttt{\%s} into the username or transaction purpose field. \\
\textbf{Impact} & As we could not identify whether this is a stack of a heap buffer overflow, we cannot clearly identify the impact. In the worst case, if the buffer overflow happens on the stack, an attacker has access to the database and the file system. \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & Low \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & High \\
\textbf{Availability} & High \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to produce a buffer overflow. \\
\textbf{Discovery} & We tried to use long strings of \texttt{a}s on the username and the description field of the uploaded transaction batch file. However, the file was either rejected with the comment that it does not satisfy the specifications or the transaction was executed. We also tried to cause buffer overflows caused by string format function by including strings like \texttt{\%s} into the username or transaction purpose field. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The SecureBank application is better in this regard, as it does not offer buffer overflow vulnerabilities.

\subsection{Testing for incubated vulnerabilities}
We did not test for incubated vulnerabilities for the reason of complexity.

\clearpage

\subsection{Testing for HTTP Splitting/Smuggling}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to find any HTTP splitting vulnerabilities. \\
\textbf{Discovery} & Using ZAP, we analyzed the response headers and found \texttt{Location} headers being sent. However, it did not appear that user inputs are sent as part of the location header. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to find any HTTP splitting vulnerabilities. \\
\textbf{Discovery} & Using ZAP, we analyzed the response headers and found \texttt{Location} headers being sent. However, it did not appear that user inputs are sent as part of the location header. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications are on the same security level in this regard.

\clearpage



\section{Error Handling}

\subsection{Analysis of Error Codes}
\subsubsection*{Online Banking}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to get reveal any information about the database, but we were able to get usual error codes of an apache server. The error pages also revealed information about the version, which is 2.2.22 on an Ubuntu server. \\
\textbf{Discovery} & By using the fuzzer \texttt{jbrofuzz / SQL Injection / MySQL Injection 101} of ZAP on the purpose field of the online transaction form, we got one response which simply stated \texttt{Database error}, but gave no further information. Using a browser, we requested the page \texttt{/InternetBanking/foobar/}, which returned a 404 error, with further information about the server operating system and the Apache version. \\
\textbf{Impact} & Using the apache version, an attacker can run known exploits for this specific version. \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & No Impact \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to get reveal any information about the database, but we were able to get usual error codes of an apache server. The error pages also revealed information about the version, which is 2.2.22 on an Ubuntu server. On the login page, we found an error code if the login was unsuccessful. Apparently, the code is always 1, if the credentials are incorrect. \\
\textbf{Discovery} & By using the fuzzer \texttt{jbrofuzz / SQL Injection / MySQL Injection 101} of ZAP on the purpose field of the online transaction form, we were not able to produce a databse error. Using a browser, we requested the page \texttt{/seccoding-2015/foobar/}, which returned a 404 error, with further information about the server operating system and the Apache version. \\
\textbf{Impact} & Using the apache version, an attacker can run known exploits for this specific version. \\
\textbf{Likelihood} & Medium \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & No Impact \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{Comparison}
Although the Online Banking application produces an error message about a database error, they provide the similar information in error messages.

\subsection{Testing for Stack Traces}
We were not able to produce stack traces in both applications using invalid inputs (e.g. negative numbers), or SQL injection.

\clearpage

\section{Testing for weak Cryptography}
\subsection{Testing for Weak SSL/TLS Ciphers, Insufficient Transport Layer Protection}
\label{subsec:encryption}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to connect to the application via HTTPS.  \\
\textbf{Discovery} & We tried to access the application via HTTPS on port 443. \\
\textbf{Impact} & An attacker can retrieve sensitive information by sniffing the network. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Medium \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}


\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were unable to connect to the application via HTTPS.  \\
\textbf{Discovery} & We tried to access the application via HTTPS on port 443. \\
\textbf{Impact} & An attacker can retrieve sensitive information by sniffing the network. \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Adjacent Network \\
\textbf{Access Complexity} & Medium \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{Comparison}
Both applications transport sensitive information about non-encrypted channels.

\clearpage


\subsection{Testing for Padding Oracle}
As there is no transport layer encryption in any of the two applications, we decided to not test for a padding oracle.

\subsection{Testing for Sensitive information sent via unencrypted channels}
All information is sent via an unencrypted channel. See Section \ref{subsec:encryption}

\clearpage












\section{Business Logic Testing}


\subsection{Test Business Logic Data Validation}
\subsubsection*{Online Banking}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & When creating transactions, it's possible to enter negative amounts, which results in gaining money at the "recipient's" cost. \\
\textbf{Discovery} & Manual testing \\
\textbf{Impact} & Medium \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & Low \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & No Impact \\
\textbf{Intigrity} & Low \\
\textbf{Availability} & No Impact \\
\end{tabular}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found no ways to make unreasonable requests, like negative money transactions. \\
\textbf{Discovery} & Manual testing \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking fails here, where our application correctly validates business data.

\clearpage


\subsection{Test Ability to Forge Requests}
\subsubsection*{Online Banking}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & None of the forms have hidden input fields that save critical information. Editing a user as admin, e.g. has a hidden user ID field. But since admins are allowed to change any user's values, that's no vulnerability. \\
\textbf{Discovery} & Firefox dev tools \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There's a hidden input field in the file upload form to limit the file size. But if we go around this by uploading by forging the request and increasing this value, we're still unable to upload files with a size of more than 3000. \\
\textbf{Discovery} & Firefox dev tools, manual \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications are securd against forged requests.

\clearpage


\subsection{Test Integrity Checks}
\subsubsection*{Online Banking}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No vulnerability found. \\
\textbf{Discovery} & ZAP \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No vulnerability found. \\
\textbf{Discovery} & ZAP \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
Both applications have sufficient integrity checks.

\clearpage


\subsection{Test for Process Timing}
\subsubsection*{Both}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Apart from blind SQL, this is not applicable, since all actions are done in atomic steps, without locking. \\
\textbf{Discovery} & n/a \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\clearpage


\subsection{Test Number of Times a Function Can be Used Limits}
\subsubsection*{Both}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There's no benefit for the users when using functions more often. Thus this isn't applicable for either of the apps. \\
\textbf{Discovery} & n/a \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\clearpage


\subsection{Testing for the Circumvention of Work Flows}
\subsubsection*{Both}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & All actions in both apps are atomic, so this doesn't apply. \\
\textbf{Discovery} & n/a \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\clearpage


\subsection{Test Defenses Against Application Mis-use}
\subsubsection*{Both}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & Defenses Against Application Mis-use aren't part of either of the applications. When sending many malicious requests at once, due to testing, neither of the applications tried to stop us. The same holds true for any attacker who wants to check the apps for vulnerabilities. \\
\textbf{Discovery} & ZAP, W3AF \\
\textbf{Impact} & Low \\
\textbf{Likelihood} & High \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & None \\
\textbf{Availability} & Low \\
\end{tabular}

\clearpage


\subsection{Test Upload of Unexpected File Types}
\subsubsection*{Both}
\begin{tabular}{l|p{10cm}}

\textbf{Observation} & While it's technically possible to upload files for transactions, these files aren't stored (or at least we couldn't find them), so this vulnerability is not applicable. \\
\textbf{Discovery} & w3af, Zap \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\clearpage



TODO!











\section{Client Side Testing}
We decided to not perform client-side testing, because we priotized it low. We focused on server-side attacks like XSS and SQL injection.
