\chapter{Detailed Report}\label{chapter:details}

\section{Configuration and Deploy Management Testing}

\subsection{Test File Extensions Handling for Sensitive Information}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found various files which are served as plain text but are PHP source files. One of these files contains the credentials of the mail server. We were also able to download the compiled executable as well as the source code of the batch file parser. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/InternetBanking/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker can get sensitive information, e.g. credentials to the mail server or the database. He can analyze the source of the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & High \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

TODO: Forced browsing results.

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found some HTML snippets, which do not contain any sensitive information, and the compiled executable of the transaction file parser. \\
\textbf{Discovery} & Using the OWASP ZAP tool, we used the forced browse functionality on \texttt{/seccoding-2015/}. We received a list of files which were found using this tool, see below. \\
\textbf{Likelihood} & This can be tested by anyone who enters specific strings into the address bar of a browser. However, the likelihood of this vulnerability is much higher if the attacker uses specific tools which test specific paths systematically. \\
\textbf{Impact} & The attacker only has access to the parser executable, which might contain information about the database connection. He can analyze the parser and find vulnerabilies there. \\
\textbf{Access Vector} & Network \\
\textbf{Access Complexity} & Low \\
\textbf{Privileges Required} & None \\
\textbf{User Interaction} & None \\
\textbf{Scope} & Unchanged \\
\textbf{Confidentiality} & Low \\
\textbf{Intigrity} & No Impact \\
\textbf{Availability} & No Impact \\
\end{tabular}

TODO: Forced browsing results.

\subsubsection*{Comparison}
The web application of the SecureBank discloses less sensitive information. However, both applications disclose information which should not be available to unauthorized persons.

\clearpage

\subsection{Test HTTP Methods}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server responded that the method \texttt{POST}, \texttt{GET}, \texttt{OPTIONS} and \texttt{HEAD} are supported.  \\
\textbf{Discovery} & We submitted the request \texttt{OPTIONS / HTTP/1.1} to the server via NetCat on port 80. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.


\clearpage
\subsection{Test HTTP Strict Transport Security}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}


\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The server did not send any \texttt{Strict-Transport-Security} header.  \\
\textbf{Discovery} & Executing the command \texttt{curl -s -D- http://vm/InternetBanking/ | grep Strict} resulted in no results. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage
\subsection{Test RIA cross domain policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & No cross domain policy files were found.  \\
\textbf{Discovery} & We scanned the traffic using ZAP. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage

\section{Identity Management Testing}

\subsection{Test Role Definitions}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & $\times$ \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients and employees & -- & $\times$ \\
Change account details and balance of clients and employees & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  We noticed that there are links to view the transaction history and change the account balance of employees, too. \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We found the following functionality for the different roles: \begin{tabular}{p{7cm}|c|c}
& \textbf{Client} & \textbf{Employee} \\\hline
View own account & $\times$ & -- \\
View own transaction history & $\times$ & -- \\
Create new transactions & $\times$ & -- \\
View account and transaction history of clients & -- & $\times$ \\
Approve transactions & -- & $\times$ \\
Approve registrations of clients and employees & -- & $\times$ \\
\end{tabular}  \\
\textbf{Discovery} & We gathered the information by exploring the web application interface manually. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The SecureBank web application does not offer a possibility for an employee to change the account balance of a client. However, the Online Banking application allows to view the transaction history and change the account balance also for employees, which have no account. This behaviour might be confusing.

\clearpage


\subsection{Test User Registration Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, a username, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. However, a person can register many times with the same username. (The activation of such an account fails with a database error.) We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or username using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & For registration, the full name, an e-mail address, a password and whether the registrant is a client or an employee are needed. Anyone can register for access. The registration has to be approved by an employee before the registrant can use the account. A person can register only one time with the same e-mail address. We could not find out, whether the registrants are verified personally before the approval. \\
\textbf{Discovery} & We tried to register several accounts with the same e-mail address and/or names using the web application. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The Online Banking web application allows the double-registration of the same username at first, it only fails at the activation. This behaviour is confusing. Also, the application should ask for the full name be able to verify the name. Otherwise, there are no significant differences between both applications.

\clearpage



\subsection{Test Account Provisioning Process}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There is no way to change the role of a user. Account requests (both, client and employee) must be approved by an employee.  \\
\textbf{Discovery} & We followed the links in the user interface and tried to login as a non-verified user. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage





\subsection{Testing for Account Enumeration and Guessable User Account}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & There are no differences in the servers response for not activated accounts, valid usernames and invalid usernames.  \\
\textbf{Discovery} & We tested the login for activated and non-activated accounts, existing and not-existing usernames and valid or invalid passwords. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
There are no significant differences between both applications.

\clearpage


\subsection{Testing for Weak or unenforced username policy}

\subsubsection*{Online Banking}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & We were not able to find a username policy.  \\
\textbf{Discovery} & We tested various usernames. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{SecureBank}

\begin{tabular}{l|p{10cm}}

\textbf{Observation} & The username has to be a valid e-mail address of the client/employee. There is no policy regarding the e-mail address.  \\
\textbf{Discovery} & We tested valid and invalid e-mail addresses. \\
\textbf{Impact} & n/a \\
\textbf{Likelihood} & n/a \\
\textbf{CVSS} & n/a \\
\end{tabular}

\subsubsection*{Comparison}
The only difference between the applications is that the Online Banking application uses usernames, which might have less correlation to the user than the e-mail address.

\clearpage
